# HA 3D Blueprint Integration

[![hacs_badge](https://img.shields.io/badge/HACS-Default-orange.svg)](https://github.com/hacs/integration)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

A Home Assistant custom integration that provides the user interface for the HA 3D Blueprint system. This integration creates buttons for tagging locations and a camera entity to display the generated home blueprint.

**This project is under active development and is considered experimental.**

---

## Overview

The HA 3D Blueprint Integration is the frontend component of the HA 3D Blueprint system. It provides:

- **Tag Buttons**: Mark corners, doorways, and update obstruction maps
- **Camera Entity**: Display the live blueprint generated by the backend engine
- **Configuration Flow**: Easy setup and sensor selection

This integration works in conjunction with the [HA 3D Blueprint Add-on](https://github.com/your-username/ha-3d-blueprint-addon) to provide a complete home mapping solution using Radio Tomographic Imaging (RTI).

## Prerequisites

Before installing this integration, ensure you have:

1. **HA 3D Blueprint Add-on**: The [Blueprint Engine Add-on](https://github.com/your-username/ha-3d-blueprint-addon) must be installed and running
2. **InfluxDB Add-on**: Required by the Blueprint Engine for data storage
3. **Bluetooth Sensors**: At least 4-5 stationary Bluetooth-enabled devices that can detect each other
4. **Mobile Beacon**: A Bluetooth beacon from your mobile device (e.g., Home Assistant Companion App's BLE Transmitter)

## Installation

### Via HACS (Recommended)

1. Open HACS in your Home Assistant instance
2. Go to "Integrations"
3. Click the three-dots menu and select "Custom repositories"
4. Add this repository URL:
   ```
   https://github.com/your-username/ha-3d-blueprint-integration
   ```
5. Select "Integration" as the category
6. Click "Add"
7. Find "HA 3D Blueprint" in the integrations list and install it
8. Restart Home Assistant

### Manual Installation

1. Download the latest release from the [releases page](https://github.com/your-username/ha-3d-blueprint-integration/releases)
2. Extract the `ha_3d_blueprint` folder to your `custom_components` directory
3. Restart Home Assistant

## Configuration

1. Go to **Settings > Devices & Services**
2. Click **"+ Add Integration"**
3. Search for **"HA 3D Blueprint"**
4. Follow the configuration flow:
   - Select your stationary Bluetooth sensor entities
   - Select your mobile beacon sensor (BLE Transmitter)
   - Optionally provide an API key for future features

## Usage

After configuration, you'll have access to:

### Buttons
- **Tag Corner**: Press when standing at a room corner to help the system learn room boundaries
- **Tag Doorway**: Press when standing in a doorway to mark passage points
- **Update Obstruction Map**: Press to update the current obstruction density map

### Camera Entity
- **3D Blueprint Live View**: Displays the current state of your home's blueprint as an SVG image
- View this in your dashboard or create automations based on blueprint changes

## How It Works

1. Your stationary Bluetooth sensors continuously monitor signal strength between each other
2. The Blueprint Engine processes this data using Radio Tomographic Imaging algorithms
3. When you press the tag buttons, the system uses your mobile beacon's current RSSI readings to refine the model
4. The system generates an SVG blueprint showing sensor locations, detected obstructions, and tagged reference points

## Troubleshooting

### Integration Not Working
- Ensure the Blueprint Engine Add-on is running on port 8124
- Check the Home Assistant logs for connection errors
- Verify your Bluetooth sensors are reporting RSSI data

### Camera Shows No Image
- Confirm the Blueprint Engine Add-on has write access to `/share/blueprint.svg`
- Check that at least one tag button has been pressed to generate initial data

### Buttons Not Responding
- Verify the mobile beacon sensor is providing current RSSI readings
- Check network connectivity between Home Assistant and the Blueprint Engine Add-on

## Development

To contribute to this project:

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Test thoroughly
5. Submit a pull request

## Support

For issues and feature requests, please use the [GitHub Issues](https://github.com/your-username/ha-3d-blueprint-integration/issues) page.

## License

This project is licensed under the MIT License - see the LICENSE file for details.
